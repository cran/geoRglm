%!PS-Adobe-3.0
%%BoundingBox: 54 72 558 720
%%Creator: Mozilla (NetScape) HTML->PS
%%DocumentData: Clean7Bit
%%Orientation: Portrait
%%Pages: 2
%%PageOrder: Ascend
%%Title: geoRglm-bookchapter-example
%%EndComments
%%BeginProlog
[ /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /space /exclam /quotedbl /numbersign /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash /zero /one
 /two /three /four /five /six /seven /eight /nine /colon /semicolon
 /less /equal /greater /question /at /A /B /C /D /E
 /F /G /H /I /J /K /L /M /N /O
 /P /Q /R /S /T /U /V /W /X /Y
 /Z /bracketleft /backslash /bracketright /asciicircum /underscore /quoteleft /a /b /c
 /d /e /f /g /h /i /j /k /l /m
 /n /o /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef /.notdef
 /space /exclamdown /cent /sterling /currency /yen /brokenbar /section /dieresis /copyright
 /ordfeminine /guillemotleft /logicalnot /hyphen /registered /macron /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered /cedilla /onesuperior /ordmasculine /guillemotright /onequarter /onehalf
 /threequarters /questiondown /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis /Igrave /Iacute /Icircumflex /Idieresis /Eth /Ntilde
 /Ograve /Oacute /Ocircumflex /Otilde /Odieresis /multiply /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls /agrave /aacute /acircumflex /atilde /adieresis /aring
 /ae /ccedilla /egrave /eacute /ecircumflex /edieresis /igrave /iacute /icircumflex /idieresis
 /eth /ntilde /ograve /oacute /ocircumflex /otilde /odieresis /divide /oslash /ugrave
 /uacute /ucircumflex /udieresis /yacute /thorn /ydieresis] /isolatin1encoding exch def
/c { matrix currentmatrix currentpoint translate
     3 1 roll scale newpath 0 0 1 0 360 arc setmatrix } bind def
/F0
    /Times-Roman findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f0 { /F0 findfont exch scalefont setfont } bind def
/F1
    /Times-Bold findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f1 { /F1 findfont exch scalefont setfont } bind def
/F2
    /Times-Italic findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f2 { /F2 findfont exch scalefont setfont } bind def
/F3
    /Times-BoldItalic findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f3 { /F3 findfont exch scalefont setfont } bind def
/F4
    /Courier findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f4 { /F4 findfont exch scalefont setfont } bind def
/F5
    /Courier-Bold findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f5 { /F5 findfont exch scalefont setfont } bind def
/F6
    /Courier-Oblique findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f6 { /F6 findfont exch scalefont setfont } bind def
/F7
    /Courier-BoldOblique findfont
    dup length dict begin
	{1 index /FID ne {def} {pop pop} ifelse} forall
	/Encoding isolatin1encoding def
    currentdict end
definefont pop
/f7 { /F7 findfont exch scalefont setfont } bind def
/rhc {
    {
        currentfile read {
	    dup 97 ge
		{ 87 sub true exit }
		{ dup 48 ge { 48 sub true exit } { pop } ifelse }
	    ifelse
	} {
	    false
	    exit
	} ifelse
    } loop
} bind def

/cvgray { % xtra_char npix cvgray - (string npix long)
    dup string
    0
    {
	rhc { cvr 4.784 mul } { exit } ifelse
	rhc { cvr 9.392 mul } { exit } ifelse
	rhc { cvr 1.824 mul } { exit } ifelse
	add add cvi 3 copy put pop
	1 add
	dup 3 index ge { exit } if
    } loop
    pop
    3 -1 roll 0 ne { rhc { pop } if } if
    exch pop
} bind def

/smartimage12rgb { % w h b [matrix] smartimage12rgb -
    /colorimage where {
	pop
	{ currentfile rowdata readhexstring pop }
	false 3
	colorimage
    } {
	exch pop 8 exch
	3 index 12 mul 8 mod 0 ne { 1 } { 0 } ifelse
	4 index
	6 2 roll
	{ 2 copy cvgray }
	image
	pop pop
    } ifelse
} def
/cshow { dup stringwidth pop 2 div neg 0 rmoveto show } bind def
/rshow { dup stringwidth pop neg 0 rmoveto show } bind def
/BeginEPSF {
  /b4_Inc_state save def
  /dict_count countdictstack def
  /op_count count 1 sub def
  userdict begin
  /showpage {} def
  0 setgray 0 setlinecap 1 setlinewidth 0 setlinejoin
  10 setmiterlimit [] 0 setdash newpath
  /languagelevel where
  { pop languagelevel 1 ne
    { false setstrokeadjust false setoverprint } if
  } if
} bind def
/EndEPSF {
  count op_count sub {pop} repeat
  countdictstack dict_count sub {end} repeat
  b4_Inc_state restore
} bind def
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
/pagelevel save def
54 0 translate
%%EndPageSetup
newpath 0 72 moveto 504 0 rlineto 0 648 rlineto -504 0 rlineto  closepath clip newpath
0 709.2 moveto
12 f0
(The commands for the example in Diggle, Ribeiro Jr and Christensen \(2002\) [) show
375.6 709.2 moveto
12 f2
(bookchapter) show
435.8 709.2 moveto
12 f0
(], and) show
0 695.9 moveto
12 f0
(Christensen and Ribeiro Jr \(2002\) [) show
169.7 695.9 moveto
12 f2
(R-news) show
205 695.9 moveto
12 f0
(].) show
0 668.8 moveto
12 f1
(WARNING: RUNNING THIS IS VERY TIME-CONSUMING AND MEMORY-DEMANDING) show
0 642.2 moveto
12 f0
(## Simulating data ) show
0 628.9 moveto
12 f0
(sim <- grf\(grid = expand.grid\(x = seq\(0.0555, 0.944444, l = 8\), y = seq\(0.0555, 0.944444, l = 8\)\),) show
0 615.6 moveto
12 f0
(cov.pars = c\(0.5, 0.2\)\) ) show
0 602.3 moveto
12 f0
(attr\(sim,"class"\) <- "geodata" ) show
0 589 moveto
12 f0
(sim$units.m <- rep\(4,64\) ) show
0 575.7 moveto
12 f0
(sim$prob <- exp\(sim$data\)/\(1+exp\(sim$data\)\) ) show
0 562.4 moveto
12 f0
(sim$data <- rbinom\(64, size = sim$units.m, prob = sim$prob\) ) show
0 535.8 moveto
12 f0
(## Visualising the data and the \(unobserved\) random effects ) show
0 522.5 moveto
12 f0
(par\(mfrow = c\(1,2\), mar=c\(2.3,2.5,.5,.7\), mgp=c\(1.5,.6,0\), cex=0.6\) ) show
0 509.2 moveto
12 f0
(plot\(c\(0, 1\), c\(-0.1, 1\), type="n", xlab="Coordinate X", ylab="Coordinate Y"\) ) show
0 495.9 moveto
12 f0
(text\(sim$coords[,1], sim$coords[,2], format\(round\(sim$prob,digits=2\)\),cex=0.9\) ) show
0 482.6 moveto
12 f0
(plot\(c\(0, 1\), c\(-0.1, 1\), type="n", xlab="Coordinate X", ylab="Coordinate Y"\) ) show
0 469.3 moveto
12 f0
(text\(sim$coords[,1], sim$coords[,2], format\(sim$data\),cex=1.1\) ) show
0 456 moveto
12 f0
(points\(sim$coords[c\(1,29\),],cex=5.5\) ) show
0 429.4 moveto
12 f0
(## Setting input options and running the function) show
0 416.1 moveto
12 f0
(prior.sim <- prior.glm.control\(beta.prior = "normal", beta = 0, beta.var = 1, phi.prior = "exponential",) show
0 402.8 moveto
12 f0
(phi = 0.2, ) show
28 389.5 moveto
12 f0
(phi.discrete = seq\(0.005,0.3, l=60\), sigmasq.prior = "sc.inv.chisq", df.sigmasq = 5, sigmasq = 0.5\) ) show
0 376.2 moveto
12 f0
(mcmc.sim <- mcmc.control\(S.scale = 0.05, phi.scale = 0.015, thin = 100, burn.in = 10000\) ) show
0 362.9 moveto
12 f0
(pred.grid <- expand.grid\(x = seq\(0.0125, 0.9875, l = 40\), y = seq\(0.0125, 0.9875, l = 40\)\) ) show
0 349.6 moveto
12 f0
(out.sim <- output.glm.control\(sim.predict = TRUE\) ) show
0 336.3 moveto
12 f0
(run.sim <- binom.krige.bayes\(sim, locations = pred.grid, prior = prior.sim, mcmc.input = mcmc.sim,) show
0 323 moveto
12 f0
(output=out.sim\) ) show
0 296.4 moveto
12 f0
(## Autocorrelations) show
0 283.1 moveto
12 f0
(require\(ts\) ) show
0 269.8 moveto
12 f0
(par\(mfrow=c\(3,2\), mar=c\(2.3,2.5,.5,.7\), mgp=c\(1.5,.6,0\), cex=0.6\) ) show
0 256.5 moveto
12 f0
(plot\(run.sim$posterior$sim[1,],type="l", ylab = "S\(0.056, 0.056\)"\) ) show
0 243.2 moveto
12 f0
(acf\(run.sim$posterior$sim[1,], main =""\) ) show
0 229.9 moveto
12 f0
(plot\(run.sim$posterior$sim[29,],type="l", ylab = "S\(0.563, 0.436\)"\) ) show
0 216.6 moveto
12 f0
(acf\(run.sim$posterior$sim[29,], main =""\) ) show
0 203.3 moveto
12 f0
(plot\(run.sim$posterior$phi.s,type="l", ylab = "phi"\) ) show
0 190 moveto
12 f0
(acf\(run.sim$posterior$phi.s, main =""\) ) show
0 163.4 moveto
12 f0
(## Plot of timeseries ) show
0 150.1 moveto
12 f0
(par\(mfrow=c\(3,1\), mar=c\(2.3,2.5,.5,.7\), mgp=c\(1.5,.6,0\), cex=0.6\) ) show
0 136.8 moveto
12 f0
(plot\(run.sim$posterior$sim[1,],type="l", ylab = "S\(0.056, 0.056\)"\) ) show
0 123.5 moveto
12 f0
(plot\(run.sim$posterior$sim[29,],type="l", ylab = "S\(0.563, 0.436\)"\) ) show
0 110.2 moveto
12 f0
(plot\(run.sim$posterior$phi.s,type="l", ylab = "phi"\) ) show
0 83.6 moveto
12 f0
(## Predictions ) show
pagelevel restore
showpage
%%Page: 2 2
%%BeginPageSetup
/pagelevel save def
54 0 translate
%%EndPageSetup
newpath 0 72 moveto 504 0 rlineto 0 648 rlineto -504 0 rlineto  closepath clip newpath
0 709.2 moveto
12 f0
(sim.predict <- apply\(run.sim$pred$sim,1,mean\) ) show
0 695.9 moveto
12 f0
(sim.predict.var <- apply\(run.sim$pred$sim,1,var\) ) show
0 682.6 moveto
12 f0
(par\(mfrow=c\(1,2\), mar=c\(2.3,2.5,.5,.7\), mgp=c\(1.5,.6,0\), cex=0.6\) ) show
0 669.3 moveto
12 f0
(image.kriging\(x= sim.predict, locations = pred.grid,values = sim.predict, col=gray\(seq\(1,0,l=30\)\), ) show
28 656 moveto
12 f0
(x.leg=c\(0.1,0.9\), y.leg = c\(-0.12,-0.07\), cex.leg=0.7, xlab="Coordinate X", ylab="Coordinate Y"\) ) show
0 642.7 moveto
12 f0
(image.kriging\(x= sim.predict.var, locations = pred.grid,values = sim.predict.var,) show
0 629.4 moveto
12 f0
(col=gray\(seq\(1,0,l=30\)\), ) show
28 616.1 moveto
12 f0
(x.leg=c\(0.1,0.9\), y.leg = c\(-0.12,-0.07\), cex.leg=0.7, xlab="Coordinate X", ylab="Coordinate Y"\) ) show
pagelevel restore
showpage
%%EOF
